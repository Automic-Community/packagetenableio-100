<?xml version="1.0" encoding="ISO-8859-15" standalone="no"?><uc-export clientvers="11.0.0">
<JOBI name="PCK.AUTOMIC_TENABLE_IO.PRV.INCLUDE.ACTIVATE_GET_SCAN_STATUS_OBJ">
<HEADER state="1">
<Title>To activate Get Scan Status Job</Title>
<ArchiveKey1/>
<ArchiveKey2/>
<OH_SubType/>
</HEADER>
<SCRIPT mode="1" state="1">
<MSCRI><![CDATA[: SET &SCAN_STATUS# = ""
: SET &SUCCESS# = 0

!Providing promptset variables
:PUT_PROMPT_BUFFER UC4RB_TIO_BASE_URL# = &UC4RB_TIO_BASE_URL#
:PUT_PROMPT_BUFFER UC4RB_TIO_ACCESS_KEYS# = &UC4RB_TIO_ACCESS_KEYS#
:PUT_PROMPT_BUFFER UC4RB_TIO_SECRET_KEYS# = &UC4RB_TIO_SECRET_KEYS#


:PUT_PROMPT_BUFFER UC4RB_TIO_SCAN_ID# = &UC4RB_TIO_SCAN_ID#


:PUT_PROMPT_BUFFER CONN_PROXY_TYPE# = &CONN_PROXY_TYPE#
:PUT_PROMPT_BUFFER CONN_PROXY_HOST# = &CONN_PROXY_HOST#
:PUT_PROMPT_BUFFER CONN_PROXY_PORT# = &CONN_PROXY_PORT#
:PUT_PROMPT_BUFFER CONN_PROXY_USERNAME# = &CONN_PROXY_USERNAME#
:PUT_PROMPT_BUFFER CONN_PROXY_PASSWORD# = &CONN_PROXY_PASSWORD#
:PUT_PROMPT_BUFFER CONN_PROXY_REALM# = &CONN_PROXY_REALM#
:PUT_PROMPT_BUFFER CONN_PROXY_AUTH_METHOD# = &CONN_PROXY_AUTH_METHOD#


:PUT_PROMPT_BUFFER CONN_CONNECTION_TIMEOUT# = &CONN_CONNECTION_TIMEOUT#
:PUT_PROMPT_BUFFER CONN_READ_TIMEOUT# = &CONN_READ_TIMEOUT#
:PUT_PROMPT_BUFFER CONN_FOLLOW_REDIRECTS# = &CONN_FOLLOW_REDIRECTS#

:PUT_PROMPT_BUFFER OVERWRITE_RA_AGENT_PROMPT# = &OVERWRITE_RA_AGENT_PROMPT#

! Invoke the job for retrieving job Status
:SET &ACTOBJ# = ACTIVATE_UC_OBJECT("PCK.AUTOMIC_TENABLE_IO.PUB.ACTION.GET_SCAN_STATUS",WAIT)

:  IF &ACTOBJ# = "0"
:     SET &ERRNR# = SYS_LAST_ERR_NR()
:     SET &ERRINS#  = SYS_LAST_ERR_INS()
:     SET &MESSAGE# = GET_MSG_TXT(&ERRNR#,&ERRINS#)
:     PRINT "ERROR: Invoking GET_SCAN_STATUS Job :&MESSAGE#"
:     SET &SUCCESS# = 1
:  ELSE
:     SET &STATUS# = GET_UC_OBJECT_STATUS(,&ACTOBJ#,"RETCODE")
:     IF &STATUS# <> "0"
:        PRINT "ERROR: GET_SCAN_STAUS Job failed. Error Status [&STATUS#]. Please check the job report for RUNID: [&ACTOBJ#]."
:        SET &SUCCESS# = 1
:     ELSE
:       SET &SCAN_STATUS# = GET_PUBLISHED_VALUE(&ACTOBJ#, UC4RB_TIO_SN_STATUS#)
:       PUBLISH &SCAN_STATUS#,,"WORKFLOW"
:       SET &SUCCESS# = 0
:     ENDIF
:  ENDIF

:IF &SUCCESS# <> 0
:   STOP MSG, 50, "ERROR: Unable to retrieve the job status."
:ENDIF
]]></MSCRI>
</SCRIPT>
<DOCU_Docu state="1" type="text">
<DOC/>
</DOCU_Docu>
</JOBI>
</uc-export>